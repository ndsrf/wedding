{
  "id": "snapshot_1769028598971_xuv5iz1t9",
  "approvalId": "approval_1769028598959_luvj7djt0",
  "approvalTitle": "Requirements Document - Wedding Checklist",
  "version": 1,
  "timestamp": "2026-01-21T20:49:58.971Z",
  "trigger": "initial",
  "status": "pending",
  "content": "# Requirements Document\n\n## Introduction\n\nThe Wedding Checklist feature provides wedding planners with a task management system to help couples stay organized throughout their wedding planning journey. This feature addresses a critical gap in the current platform—while planners can manage guest lists and RSVPs, there's no systematic way to track the hundreds of tasks required for wedding preparation.\n\nThe checklist system uses a template-based approach where planners create reusable task templates that are automatically copied to each new wedding. Both planners and wedding admins (couples) can collaboratively manage these tasks, with clear assignment tracking and deadline management. The system includes dashboard widgets that surface upcoming tasks for both couples and planners, ensuring nothing falls through the cracks.\n\nThis feature differentiates the platform from pure RSVP management tools by providing comprehensive wedding planning support, increasing the value proposition for wedding planners and reducing the likelihood of couples seeking additional planning tools.\n\n## Alignment with Product Vision\n\nThis feature directly supports the product vision in multiple ways:\n\n1. **Planner Success = Product Success**: By providing task management capabilities, planners can offer more comprehensive services to their clients without additional tools, increasing planner satisfaction and retention.\n\n2. **Progressive Disclosure**: The template system allows planners to start simple (use a basic template) or go deep (create highly customized templates with sections and dynamic dates), following the principle of revealing complexity only when needed.\n\n3. **Mobile-First**: The checklist interface is designed for mobile interaction with large touch targets, easy checkbox toggling, and responsive grid layouts that work on phones.\n\n4. **Multi-Tenancy**: Task templates are planner-scoped, and wedding-specific checklists maintain complete data isolation per wedding, consistent with the platform's data isolation principles.\n\n5. **Cultural Context**: Spanish wedding planning is detail-intensive and family-centric. The collaborative editing and assignment tracking supports planners working with couples who may have multiple family members involved in planning.\n\n6. **Observability Without Surveillance**: Notifications track task assignments and completions for workflow purposes (so couples know when planners assign them tasks), not for surveillance.\n\nThis feature enables the future vision of \"Task Management Integration\" (Phase 8) mentioned in product.md, laying the groundwork for potential integration with external tools like Google Tasks while providing immediate value with a native solution.\n\n## Requirements\n\n### Requirement 1: Template Creation and Management\n\n**User Story:** As a wedding planner, I want to create and edit task templates, so that I can reuse my standard wedding planning workflow across all my client weddings.\n\n#### Acceptance Criteria\n\n1. WHEN a planner accesses the template editor THEN the system SHALL display a grid interface with columns: Checkbox, Title, Description, Assigned To, Status, Due Date\n2. WHEN a planner adds a new task to the template THEN the system SHALL allow entering:\n   - Title (required, max 200 characters)\n   - Description (optional, rich text with URL support)\n   - Assigned To dropdown (Wedding Planner, Couple, Other - translated to user language)\n   - Due Date with support for relative dates (e.g., \"Wedding Date - 3 months\", \"Wedding Date + 1 week\")\n   - Default status (defaults to pending)\n3. WHEN a planner organizes tasks into sections THEN the system SHALL allow creating named sections (e.g., \"Initial Tasks\", \"Wedding Week Tasks\") and dragging tasks between sections\n4. WHEN a planner saves template changes THEN the system SHALL persist changes immediately and display confirmation\n5. IF a template already exists for a planner THEN the system SHALL load the existing template for editing\n6. WHEN a planner deletes a task from the template THEN the system SHALL confirm deletion and remove the task without affecting existing wedding checklists\n\n### Requirement 2: Template to Wedding Copying\n\n**User Story:** As the system, I want to automatically copy the planner's template to each new wedding, so that every wedding starts with a complete task list without manual setup.\n\n#### Acceptance Criteria\n\n1. WHEN a new wedding is created THEN the system SHALL copy the planner's current template to the wedding as an independent checklist\n2. WHEN copying the template THEN the system SHALL convert relative due dates to absolute dates based on the wedding date\n   - Example: If wedding date is June 15, 2026 and task has \"Wedding Date - 3 months\", absolute date becomes March 15, 2026\n3. WHEN copying the template THEN the system SHALL preserve:\n   - All task titles, descriptions, sections\n   - Assignment values (Wedding Planner, Couple, Other)\n   - Section organization\n4. WHEN the template is copied THEN the system SHALL set all task statuses to \"Pending\" and checkboxes to unchecked\n5. IF the planner updates the template after weddings are created THEN the system SHALL NOT modify existing wedding checklists (one-time copy, not linked)\n6. WHEN copying the template THEN the system SHALL complete the operation within 2 seconds for templates with up to 100 tasks\n\n### Requirement 3: Wedding Checklist Collaborative Editing\n\n**User Story:** As a wedding admin (couple) or wedding planner, I want to edit the wedding checklist collaboratively, so that we can both manage tasks and track progress together.\n\n#### Acceptance Criteria\n\n1. WHEN a planner or wedding admin accesses the wedding screen THEN the system SHALL display a \"Wedding Checklist\" section in the navigation\n2. WHEN accessing the Wedding Checklist section THEN the system SHALL display a grid interface showing all tasks organized by section\n3. WHEN a user edits a task THEN the system SHALL allow modifying:\n   - Checkbox (completed/uncompleted)\n   - Title\n   - Description (rich text editor with URL support)\n   - Assigned To\n   - Due Date (absolute dates only, not relative)\n4. WHEN a user checks the checkbox THEN the system SHALL automatically set the task status to \"Completed\"\n5. WHEN a user unchecks a completed task THEN the system SHALL revert the status to \"Pending\"\n6. WHEN a user adds a new task to the wedding checklist THEN the system SHALL allow adding tasks to existing sections or creating new sections\n7. WHEN a user deletes a task THEN the system SHALL prompt for confirmation and remove the task from the wedding checklist\n8. WHEN either planner or admin makes changes THEN the system SHALL save changes immediately and display them to both users (eventual consistency acceptable, no real-time WebSocket required for MVP)\n\n### Requirement 4: Rich Text Description Support\n\n**User Story:** As a wedding planner or admin, I want to add formatted descriptions with links to tasks, so that I can provide detailed instructions and reference external resources.\n\n#### Acceptance Criteria\n\n1. WHEN editing a task description THEN the system SHALL provide a rich text editor with formatting options:\n   - Bold, italic, underline\n   - Bullet lists and numbered lists\n   - Hyperlinks with URL validation\n2. WHEN entering a URL THEN the system SHALL validate the URL format and create a clickable link\n3. WHEN displaying task descriptions THEN the system SHALL render the formatted text with proper styling\n4. WHEN displaying links THEN the system SHALL open links in a new browser tab when clicked\n5. IF a description exceeds 2000 characters THEN the system SHALL truncate with \"Read more\" expansion\n6. WHEN rendering rich text THEN the system SHALL sanitize HTML to prevent XSS attacks\n\n### Requirement 5: Task Assignment Notifications\n\n**User Story:** As a wedding admin (couple), I want to receive notifications when tasks are assigned to me or when tasks are completed, so that I stay informed about what I need to do.\n\n#### Acceptance Criteria\n\n1. WHEN a task is assigned to \"Couple\" (by planner or system copy) THEN the system SHALL create a notification for the wedding admin with:\n   - Event type: \"Task Assigned\"\n   - Task title\n   - Due date\n   - Timestamp of assignment\n2. WHEN a task assigned to \"Couple\" is marked as completed THEN the system SHALL create a notification for the wedding planner with:\n   - Event type: \"Task Completed by Couple\"\n   - Task title\n   - Completion timestamp\n   - Who completed it (wedding admin name)\n3. WHEN a task assigned to \"Wedding Planner\" is marked as completed THEN the system SHALL create a notification for the wedding admin with:\n   - Event type: \"Task Completed by Planner\"\n   - Task title\n   - Completion timestamp\n4. WHEN notifications are created THEN the system SHALL add them to the existing notification feed (same infrastructure as RSVP notifications)\n5. WHEN notifications are displayed THEN the system SHALL allow filtering by event type (Task Assigned, Task Completed)\n6. WHEN a user clicks a task notification THEN the system SHALL navigate to the wedding checklist screen with the relevant task highlighted\n\n### Requirement 6: Upcoming Tasks Widget - Admin Dashboard\n\n**User Story:** As a wedding admin (couple), I want to see my upcoming assigned tasks on my dashboard, so that I can quickly see what I need to do without navigating to the full checklist.\n\n#### Acceptance Criteria\n\n1. WHEN a wedding admin accesses the /admin page THEN the system SHALL display a table titled \"Assigned Tasks Coming Up Soon\"\n2. WHEN displaying the upcoming tasks table THEN the system SHALL show the next 5 tasks assigned to \"Couple\", sorted by due date (earliest first)\n3. WHEN displaying each task THEN the system SHALL show:\n   - Task title\n   - Due date\n   - Section name (if applicable)\n   - Color-coded indicator based on due date\n4. WHEN a task is past due THEN the system SHALL highlight the row in red (#EF4444)\n5. WHEN a task has a due date within 1 month THEN the system SHALL highlight the row in orange (#F59E0B)\n6. WHEN a task has a due date more than 1 month away THEN the system SHALL highlight the row in green (#10B981)\n7. WHEN a user clicks a task row THEN the system SHALL navigate to the Wedding Checklist screen\n8. IF there are fewer than 5 upcoming tasks THEN the system SHALL display all available tasks\n9. IF there are no upcoming tasks THEN the system SHALL display a message \"No upcoming tasks assigned to you\"\n10. WHEN calculating upcoming tasks THEN the system SHALL exclude completed tasks\n\n### Requirement 7: Upcoming Tasks Widget - Planner Dashboard\n\n**User Story:** As a wedding planner, I want to see upcoming tasks assigned to me across all my weddings, so that I can prioritize my work and ensure I don't miss critical deadlines.\n\n#### Acceptance Criteria\n\n1. WHEN a planner accesses the /planner page THEN the system SHALL display a table titled \"Assigned Tasks Coming Up Soon\"\n2. WHEN displaying the upcoming tasks table THEN the system SHALL show the next 3 tasks assigned to \"Wedding Planner\" for EACH wedding, sorted by due date (earliest first)\n3. WHEN displaying each task THEN the system SHALL show:\n   - Wedding name (couple names)\n   - Task title\n   - Due date\n   - Section name (if applicable)\n   - Color-coded indicator based on due date\n4. WHEN a task is past due THEN the system SHALL highlight the row in red (#EF4444)\n5. WHEN a task has a due date within 1 month THEN the system SHALL highlight the row in orange (#F59E0B)\n6. WHEN a task has a due date more than 1 month away THEN the system SHALL highlight the row in green (#10B981)\n7. WHEN a user clicks a task row THEN the system SHALL navigate to the Wedding Checklist screen for that specific wedding\n8. IF a wedding has fewer than 3 upcoming tasks THEN the system SHALL display all available tasks for that wedding\n9. IF a wedding has no upcoming tasks THEN the system SHALL NOT display that wedding in the table\n10. WHEN calculating upcoming tasks THEN the system SHALL exclude completed tasks\n11. WHEN displaying tasks across multiple weddings THEN the system SHALL group by wedding and show wedding name clearly\n\n### Requirement 8: Grid-Like Editing Experience\n\n**User Story:** As a planner or admin, I want to edit the checklist as easily as a spreadsheet, so that I can quickly make changes without navigating through multiple forms.\n\n#### Acceptance Criteria\n\n1. WHEN viewing the checklist THEN the system SHALL display tasks in a table/grid format with inline editing\n2. WHEN a user clicks a cell THEN the system SHALL activate editing mode for that cell without opening a modal\n3. WHEN editing a cell THEN the system SHALL show the appropriate input:\n   - Text input for title\n   - Rich text editor inline for description\n   - Dropdown for \"Assigned To\"\n   - Date picker for due date\n   - Checkbox for completion status\n4. WHEN a user presses Tab THEN the system SHALL move to the next editable cell (keyboard navigation)\n5. WHEN a user presses Enter on title field THEN the system SHALL save and move to the next row\n6. WHEN a user clicks outside an editing cell THEN the system SHALL save changes automatically\n7. WHEN displaying on mobile THEN the system SHALL use a responsive card layout instead of grid (mobile-first principle)\n8. WHEN displaying on desktop THEN the system SHALL show full grid with all columns visible\n9. WHEN dragging tasks THEN the system SHALL allow reordering tasks within sections and moving between sections\n\n## Non-Functional Requirements\n\n### Code Architecture and Modularity\n\n- **Single Responsibility Principle**: Separate modules for template management, checklist CRUD operations, date conversion logic, notification creation, and dashboard widgets\n- **Modular Design**: Reusable components for task grid, task row, rich text editor, date picker, and upcoming tasks widget\n- **Dependency Management**: Checklist functionality should not depend on RSVP or payment modules; use shared notification infrastructure\n- **Clear Interfaces**: Define TypeScript interfaces for Task, TaskTemplate, Section, NotificationEvent\n\n### Performance\n\n- **Template Copying**: Must complete within 2 seconds for templates with up to 100 tasks\n- **Checklist Load Time**: Full checklist (up to 200 tasks across 10 sections) must load within 1 second\n- **Inline Editing**: Cell edit activation must be instant (<100ms) for responsive feel\n- **Dashboard Widgets**: Upcoming tasks widgets must load within 500ms (query optimization required)\n- **Rich Text Rendering**: Descriptions with formatted text and links must render without layout jank\n\n### Security\n\n- **Multi-Tenancy Isolation**: Template access must be scoped to planner_id; checklist access must be scoped to wedding_id\n- **Access Control**: Verify user has access to wedding before allowing checklist edits\n- **XSS Prevention**: Sanitize all rich text descriptions using DOMPurify or equivalent\n- **SQL Injection Prevention**: Use Prisma parameterized queries for all database operations\n- **Authorization**: Wedding admins can only edit checklists for their wedding; planners can edit checklists for weddings they manage\n\n### Reliability\n\n- **Data Persistence**: All checklist edits must be persisted immediately with optimistic UI updates and rollback on failure\n- **Notification Delivery**: Task assignment and completion notifications must be created reliably (99.9% success rate)\n- **Template Integrity**: Template edits must not corrupt existing wedding checklists\n- **Concurrent Editing**: Handle concurrent edits by planner and admin gracefully (last-write-wins with optimistic locking)\n\n### Usability\n\n- **Mobile-First**: Checklist must be fully functional on mobile devices with touch-friendly controls (≥44px touch targets)\n- **Keyboard Navigation**: Full keyboard support for grid navigation (Tab, Enter, Escape, Arrow keys)\n- **Visual Feedback**: Clear visual indicators for task status (completed vs. pending), due date urgency, and assignment\n- **Language Support**: All interface text and dropdown values must be translated to all 5 supported languages (Spanish, English, French, Italian, German)\n- **Accessibility**: WCAG 2.1 AA compliance for grid navigation, rich text editing, and color-coding (don't rely solely on color)\n- **Progressive Disclosure**: Collapse sections by default on mobile; expand all on desktop\n- **Error Handling**: Clear error messages for validation failures (e.g., invalid date, missing title)\n",
  "fileStats": {
    "size": 16459,
    "lines": 232,
    "lastModified": "2026-01-21T20:49:35.551Z"
  },
  "comments": []
}